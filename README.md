## Narrative

A few years ago, we did a [comparison study](https://doi.org/10.1016/j.ecolmodel.2017.08.003) between multiple models for predicting phenological events including cherry blossom. Many of these models are based on the concept of thermal time which assumes phenological development is primarily driven by a certain amount of heat or chill accumulation that the plant has been exposed to. While there are other environmental cues like photoperiod and precipitation which may also affect how phenology unfolds, it is known that temperature is the primary driver for phenology development for cherry blossom. Among those many thermal-driven models, however, it was not clear which model was the best in terms of prediction accuracy. In the end, we came up with an ensemble model which basically sums up predictions from all available models. The ensemble model was not clearly the best either, but at least it performed as good as other individual models when put under various prediction scenarios.

My solution for the competition comes from there. I picked two representative phenology models: Days Transferred to Standard Temperature (DTS) model and Chilling-forcing (CF) model. [DTS model](https://doi.org/10.1002/joc.3839) is a single step accumulation model conceptually similar to more commonly used Growing Degree Days (GDD) model and consistently showed a good performance in our experiments. [CF model](https://doi.org/10.1371/journal.pone.0027439) is more physiologically informed that it distinguishes an explicit chilling period to release endodormancy followed by the forcing period which is basically what single step models try to capture. It's notable that despite its biological significance, especially under long-term climate change projections, more complex two steps models did not necessarily outperform single step models in the current and past conditions.

Illustratively, DTS model is conservative in a sense and tends to have smaller variations in the predictions under different temperature regimes. On the other hand, CF model is more sensitive to temperature changes and good at picking up temporal variations, but at the same time, susceptible to overshooting. Here, I built a simple mean ensemble to combine these two models in hopes of taking the best of both worlds.

Mathematical formulations for these models can be found in the cited papers. Technically, they are implemented in Julia language using [Cropbox modeling framework](https://github.com/cropbox/Cropbox.jl). Required temperature data were obtained from the [Global Historical Climatology Network daily (GHCNd)](https://www.ncei.noaa.gov/products/land-based-station/global-historical-climatology-network-daily) dataset. Individual models were initially calibrated to the recent three decades of temperature data since 1990. Then an ensemble model was formed by taking a mean response from two models. As shown in the notebook, the simple ensemble performed much better than individual models for the training dataset.

For future predictions, a new temperature dataset was generated by averaging previous 10 years of daily temperature records. This method may not be robust in a sense that the later years will exhibit a higher degree of autocorrelation to the previously generated years, but at least provided a ground for the models to work, especially for the current year (2022). If a more reliable data source for the future temperature projection was available, more accurate predictions could be achieved for the remaining years up to 2031.

Cherry blossom in Vancouver, which has no existing observation dataset, is assumed to undergo phenological process similar to the trees in Washington D.C. as suggested by the same Yoshino cherry species (*Prunus × yedoensis*) and a comparable geographic location (latitude: 49°N in Vancouver, 39°N in D.C.).


## Usage

Here are steps to reproduce the analysis.

1. *(optional)* Run `fetch_ghcnd.R` script (R) to download GHCNd datasets in `data/ghcnd` directory.
2. *(optional)* Run `save_ghcnd.py` script (Python) to generate extrapolated CSV files in `data/ghcnd` directory.
3. Load `model.ipynb` notebook (Julia) in the Jupyter Notebook.

You may need to install any required dependencies for each language.


## References

1. [K. Yun *et al.* (2017)](https://doi.org/10.1016/j.ecolmodel.2017.08.003). 
Can a multi-model ensemble improve phenology predictions for climate change studies?,
Ecological Modelling, 362, 54-64.

2. [J. Hur *et al.* (2014)](https://doi.org/10.1002/joc.3839). The change of cherry first-flowering date over South Korea projected from downscaled IPCC AR5 simulation, International Journal of Climatology, 34, 2308-2319.

3. [U. Chung *et al.* (2011)](https://doi.org/10.1371/journal.pone.0027439). Predicting the timing of cherry blossoms in Washington, DC and Mid-Atlantic States in response to climate change, PLoS One, 6, e27439.
